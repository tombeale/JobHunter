@using BlueSite.Data.Entities
@inject BlueSiteContext _context

    <div class="bullet-point-edit nobreak">
        @if (Point.Id > 0)
        {
            <DragHandle Index="@Index.ToString()" Image="Bars" ToolTip="Drag to set the bullet order" />
        }
        else
        {
            <Spacer Width="20" />
        }
        <input type="text" onkeypress="triggerChangeOnEnter(event, this)" class="form-control inset" @onchange='e => HandleChange(e.Value.ToString())' value="@Point.Text" />
    </div>


@code {

    [Parameter]
    public int Index { get; set; }

    [Parameter]
    public BlueSite.Data.Entities.TopicPoint Point { get; set; }

    [Parameter]
    public EventCallback HandlePointChange { get; set; }

    [Parameter]
    public bool IsNew { get; set; }

    async void HandleChange(string value)
    {
        Point.Text = value;
        if (IsNew)
        {
            _context.TopicPoints.Add(new TopicPoint(Point));
        }
        await HandlePointChange.InvokeAsync(value);
        StateHasChanged();
    }

}
